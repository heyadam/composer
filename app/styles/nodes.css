/* ============================================
   Node Design System — Refined Minimal
   ============================================

   TOKENS
   ------
   Spacing: --node-space-{xs|sm|md|lg|xl} (4-14px)
   Borders: --node-border-{strong|medium|subtle} (0.1/0.06/0.03)
   Backgrounds: --node-bg-{strong|medium|subtle} (0.05/0.03/0.02)
   Text: --node-text-{primary|secondary|muted|placeholder}
   Shadows: --node-shadow-{sm|md|lg}

   ACCENT COLORS (8)
   -----------------
   violet (text-input), fuchsia (image-input), cyan (text-gen)
   rose (image-gen), amber (ai-logic), emerald (output)
   blue (react), teal (audio)

   PORT COLORS (6)
   ---------------
   cyan=string, purple=image, amber=response
   emerald=audio, rose=boolean, orange=pulse

   FORM STATES
   -----------
   .node-input-error, .node-input-valid

   COMMENT COLORS (7)
   ------------------
   gray, blue, green, yellow, purple, pink, orange
*/

/* ============================================
   Design Tokens
   ============================================ */
:root {
  /* Spacing Scale */
  --node-space-xs: 0.25rem;   /* 4px */
  --node-space-sm: 0.375rem;  /* 6px */
  --node-space-md: 0.625rem;  /* 10px */
  --node-space-lg: 0.75rem;   /* 12px */
  --node-space-xl: 0.875rem;  /* 14px */

  /* Border Opacity Hierarchy (3 tiers) */
  --node-border-strong: 0.1;
  --node-border-medium: 0.06;
  --node-border-subtle: 0.03;

  /* Background Opacities */
  --node-bg-strong: 0.05;
  --node-bg-medium: 0.03;
  --node-bg-subtle: 0.02;

  /* Text Opacities (high contrast) */
  --node-text-primary: 0.95;
  --node-text-secondary: 0.75;
  --node-text-muted: 0.60;
  --node-text-placeholder: 0.40;

  /* Shadow Tokens */
  --node-shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
  --node-shadow-md: 0 4px 16px rgba(0, 0, 0, 0.3);
  --node-shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.25);

  /* Node Accent Colors - "Luminous Precision" palette */
  --node-violet: 180 160 230;   /* Soft violet - text input */
  --node-fuchsia: 201 184 250;  /* Lavender bloom - image input */
  --node-cyan: 142 200 246;     /* Soft azure - text generation */
  --node-rose: 246 168 184;     /* Soft coral - image generation */
  --node-amber: 246 217 142;    /* Champagne gold - ai logic */
  --node-emerald: 160 230 200;  /* Soft sage - preview output */
  --node-blue: 160 190 246;     /* Periwinkle - react component */
  --node-teal: 142 246 228;     /* Electric mint - audio */

  /* Port Colors - "Luminous Precision" palette (data type indicators) */
  --port-cyan: 142 200 246;     /* Soft azure - string/text */
  --port-purple: 201 184 250;   /* Lavender bloom - image */
  --port-amber: 246 217 142;    /* Champagne gold - response */
  --port-emerald: 142 246 228;  /* Electric mint - audio */
  --port-rose: 246 168 184;     /* Soft coral - boolean */
  --port-orange: 246 200 142;   /* Apricot signal - pulse */

  /* Comment Theme Colors */
  --node-comment-gray: 161 161 170;
  --node-comment-blue: 96 165 250;
  --node-comment-green: 74 222 128;
  --node-comment-yellow: 250 204 21;
  --node-comment-purple: 192 132 252;
  --node-comment-pink: 244 114 182;
  --node-comment-orange: 251 146 60;
}

/* ============================================
   Node Frame — Base Container
   ============================================ */
.node-frame {
  @apply relative;
  isolation: isolate;
  background: rgba(30, 30, 34, 0.9);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, var(--node-border-strong));
  border-radius: 14px;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.05),
    var(--node-shadow-sm),
    var(--node-shadow-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: visible;
}

.node-frame::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 14px;
  padding: 1px;
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.08) 0%,
    rgba(255, 255, 255, 0) 40%
  );
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

.node-frame:hover {
  border-color: rgba(255, 255, 255, var(--node-border-strong));
  box-shadow:
    var(--node-shadow-sm),
    var(--node-shadow-lg);
}

/* ============================================
   Node Sections
   ============================================ */
.node-header {
  @apply flex items-center gap-2.5 px-3.5 py-2.5;
  border-bottom: 1px solid rgba(255, 255, 255, var(--node-border-subtle));
}

.node-body {
  @apply px-3.5 py-3;
}

.node-footer {
  /* Empty wrapper - no styling so it blends when NodeFooter returns null */
}

.node-footer-content {
  @apply px-3.5 py-2.5;
  background: rgba(0, 0, 0, 0.15);
  border-top: 1px solid rgba(255, 255, 255, var(--node-border-subtle));
  border-radius: 0 0 14px 14px;
}

.node-ports {
  @apply px-3.5 py-1.5;
}

/* ============================================
   Node Header Elements
   ============================================ */
.node-icon {
  @apply flex items-center justify-center shrink-0;
  width: 28px;
  height: 28px;
  border-radius: 8px;
  background: rgba(var(--node-accent-rgb), 0.12);
}

.node-icon svg {
  width: 14px;
  height: 14px;
  color: rgb(var(--node-accent-rgb));
  opacity: 0.9;
}

.node-title {
  font-size: 13px;
  font-weight: 500;
  line-height: 1.3;
  letter-spacing: -0.01em;
  color: rgba(255, 255, 255, var(--node-text-primary));
}

/* ============================================
   Accent Color Classes
   ============================================ */
.node-accent-violet { --node-accent-rgb: var(--node-violet); }
.node-accent-fuchsia { --node-accent-rgb: var(--node-fuchsia); }
.node-accent-cyan { --node-accent-rgb: var(--node-cyan); }
.node-accent-rose { --node-accent-rgb: var(--node-rose); }
.node-accent-amber { --node-accent-rgb: var(--node-amber); }
.node-accent-emerald { --node-accent-rgb: var(--node-emerald); }
.node-accent-blue { --node-accent-rgb: var(--node-blue); }
.node-accent-teal { --node-accent-rgb: var(--node-teal); }

/* Comment accent colors */
.node-accent-comment-gray { --node-accent-rgb: var(--node-comment-gray); }
.node-accent-comment-blue { --node-accent-rgb: var(--node-comment-blue); }
.node-accent-comment-green { --node-accent-rgb: var(--node-comment-green); }
.node-accent-comment-yellow { --node-accent-rgb: var(--node-comment-yellow); }
.node-accent-comment-purple { --node-accent-rgb: var(--node-comment-purple); }
.node-accent-comment-pink { --node-accent-rgb: var(--node-comment-pink); }
.node-accent-comment-orange { --node-accent-rgb: var(--node-comment-orange); }

/* ============================================
   Port Handles & Labels
   ============================================ */
.port-handle {
  width: 10px !important;
  height: 10px !important;
  border-radius: 50% !important;
  border: 2px solid rgba(17, 17, 17, 0.9) !important;
  box-shadow:
    0 0 0 1px rgba(255, 255, 255, 0.08),
    0 1px 3px rgba(0, 0, 0, 0.2) !important;
  transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.port-handle:hover {
  transform: scale(1.15) !important;
  box-shadow:
    0 0 0 1px rgba(255, 255, 255, 0.15),
    0 0 8px currentColor,
    0 2px 4px rgba(0, 0, 0, 0.2) !important;
}

/* Port colors - use CSS variables from :root */
.port-cyan {
  background-color: rgb(var(--port-cyan)) !important;
  color: rgb(var(--port-cyan));
}
.port-purple {
  background-color: rgb(var(--port-purple)) !important;
  color: rgb(var(--port-purple));
}
.port-amber {
  background-color: rgb(var(--port-amber)) !important;
  color: rgb(var(--port-amber));
}
.port-emerald {
  background-color: rgb(var(--port-emerald)) !important;
  color: rgb(var(--port-emerald));
}
.port-rose {
  background-color: rgb(var(--port-rose)) !important;
  color: rgb(var(--port-rose));
}
.port-orange {
  background-color: rgb(var(--port-orange)) !important;
  color: rgb(var(--port-orange));
}

.port-label {
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0;
  color: rgba(255, 255, 255, var(--node-text-muted));
  transition: color 0.15s ease;
}

/* ============================================
   Execution States
   ============================================ */
.node-running {
  border-color: rgba(var(--node-accent-rgb), 0.4) !important;
  box-shadow:
    var(--node-shadow-sm),
    0 0 20px -4px rgba(var(--node-accent-rgb), 0.35),
    var(--node-shadow-lg) !important;
}

.node-success {
  border-color: rgba(52, 211, 153, 0.35) !important;
  box-shadow:
    var(--node-shadow-sm),
    0 0 16px -4px rgba(52, 211, 153, 0.25),
    var(--node-shadow-lg) !important;
}

.node-error {
  border-color: rgba(251, 113, 133, 0.4) !important;
  box-shadow:
    var(--node-shadow-sm),
    0 0 16px -4px rgba(251, 113, 133, 0.3),
    var(--node-shadow-lg) !important;
}

/* ============================================
   Status Indicators
   ============================================ */
.status-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  box-shadow: 0 0 4px currentColor;
}

.status-dot-running {
  background: rgb(var(--node-accent-rgb));
  animation: status-pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

.status-dot-success {
  background: rgb(52 211 153);
}

.status-dot-error {
  background: rgb(251 113 133);
}

.status-dot-cached {
  background: rgba(255, 255, 255, 0.25);
  box-shadow: none;
}

@keyframes status-pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(0.95); }
}

/* ============================================
   Form Inputs
   ============================================ */
.node-input {
  @apply w-full px-3 py-2 text-[13px];
  background: rgba(255, 255, 255, var(--node-bg-medium));
  border: 1px solid rgba(255, 255, 255, var(--node-border-medium));
  border-radius: 8px;
  color: rgba(255, 255, 255, var(--node-text-primary));
  transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
}

.node-input::placeholder {
  color: rgba(255, 255, 255, var(--node-text-placeholder));
}

.node-input:focus {
  outline: none;
  background: rgba(255, 255, 255, var(--node-bg-strong));
  border-color: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.04);
}

.node-input:disabled {
  background: transparent;
  border-style: dashed;
  border-color: rgba(255, 255, 255, var(--node-border-subtle));
  color: rgba(255, 255, 255, 0.35);
}

/* Error state */
.node-input-error {
  border-color: rgba(251, 113, 133, 0.4) !important;
  background: rgba(251, 113, 133, 0.05);
}

.node-input-error:focus {
  border-color: rgba(251, 113, 133, 0.6) !important;
  box-shadow: 0 0 0 2px rgba(251, 113, 133, 0.1);
}

/* Valid state */
.node-input-valid {
  border-color: rgba(52, 211, 153, 0.3) !important;
}

.node-input-valid:focus {
  border-color: rgba(52, 211, 153, 0.5) !important;
  box-shadow: 0 0 0 2px rgba(52, 211, 153, 0.08);
}

/* ============================================
   Upload Zone
   ============================================ */
.node-upload-zone {
  @apply flex flex-col items-center justify-center gap-1.5 cursor-pointer;
  background: rgba(255, 255, 255, var(--node-bg-subtle));
  border: 1px dashed rgba(255, 255, 255, var(--node-border-strong));
  border-radius: 8px;
  color: rgba(255, 255, 255, 0.35);
  transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
}

.node-upload-zone:hover {
  background: rgba(255, 255, 255, 0.04);
  border-color: rgba(255, 255, 255, 0.18);
  color: rgba(255, 255, 255, 0.55);
}

/* ============================================
   Checkbox
   ============================================ */
.node-checkbox {
  width: 14px;
  height: 14px;
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 4px;
  accent-color: rgb(var(--node-accent-rgb));
  transition: all 0.15s ease;
}

.node-checkbox:hover {
  border-color: rgba(255, 255, 255, 0.2);
}

.node-checkbox:checked {
  background: rgb(var(--node-accent-rgb));
  border-color: rgb(var(--node-accent-rgb));
}

/* ============================================
   Config Row
   ============================================ */
.node-config-row {
  @apply flex items-center justify-between gap-3;
}

.node-config-label {
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0;
  color: rgba(255, 255, 255, var(--node-text-muted));
}

/* ============================================
   Comment Node
   ============================================ */
.node-comment {
  background: rgba(30, 30, 34, 0.6);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, var(--node-border-strong));
  border-top-width: 3px;
  border-top-style: solid;
  border-radius: 14px;
  box-shadow: var(--node-shadow-sm), var(--node-shadow-md);
  overflow: hidden;
}

.node-comment-header {
  @apply flex items-start gap-2 px-3 py-2;
  background: rgba(var(--node-accent-rgb), 0.1);
  border-bottom: 1px solid rgba(255, 255, 255, var(--node-border-subtle));
}

.node-comment-icon {
  @apply mt-0.5 shrink-0;
  width: 16px;
  height: 16px;
  color: rgb(var(--node-accent-rgb));
}

.node-comment-title {
  @apply text-sm font-medium cursor-text truncate;
  color: rgb(var(--node-accent-rgb));
}

.node-comment-title:hover {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  padding: 0 4px;
  margin: 0 -4px;
}

.node-comment-description {
  @apply text-xs mt-1 cursor-text line-clamp-2;
  color: rgba(255, 255, 255, 0.7);
}

.node-comment-description:hover {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  padding: 0 4px;
  margin: 0 -4px;
}

/* Comment color variants - border-top-color */
.node-comment-gray {
  border-top-color: rgb(var(--node-comment-gray));
  --node-accent-rgb: var(--node-comment-gray);
}
.node-comment-blue {
  border-top-color: rgb(var(--node-comment-blue));
  --node-accent-rgb: var(--node-comment-blue);
}
.node-comment-green {
  border-top-color: rgb(var(--node-comment-green));
  --node-accent-rgb: var(--node-comment-green);
}
.node-comment-yellow {
  border-top-color: rgb(var(--node-comment-yellow));
  --node-accent-rgb: var(--node-comment-yellow);
}
.node-comment-purple {
  border-top-color: rgb(var(--node-comment-purple));
  --node-accent-rgb: var(--node-comment-purple);
}
.node-comment-pink {
  border-top-color: rgb(var(--node-comment-pink));
  --node-accent-rgb: var(--node-comment-pink);
}
.node-comment-orange {
  border-top-color: rgb(var(--node-comment-orange));
  --node-accent-rgb: var(--node-comment-orange);
}
